# Ubon v1.1.0 - Comprehensive Improvement Plan

## ðŸŽ¯ Overview
This document tracks all planned improvements for Ubon v1.1.0, building on the solid foundation of v1.0.4. The focus is on enhanced user experience, better output organization, and expanded capabilities while maintaining backward compatibility.

## âœ… Completed (Ready for 1.1.0)

### P1 - Colorized Output & Branding
- âœ… **Colorized CLI output** with chalk theme and lotus emoji (ðŸª·) [[memory:7044488]]
- âœ… **`--color auto|always|never`** flag for all commands
- âœ… **Brand consistency** with `#c99cb3` color throughout output
- âœ… **Conditional colorization** respects TTY detection and NO_COLOR env

## ðŸš§ In Progress - Priority 1 (Core UX)

### P1 - Result Organization & Grouping
- ðŸ”„ **`--group-by file|rule`** - Organize output by file or rule type
- ðŸ”„ **`--min-severity warning|error`** - Filter by minimum severity level  
- ðŸ”„ **`--max-issues N`** - Limit output to top N critical issues
- ðŸ”„ **Deduplication logic** - Collapse repeated findings across files

### P1 - Contextual Information
- ðŸ”„ **Code context snippets** - Show 3-5 lines around each finding
- ðŸ”„ **"Why it matters" explanations** - Brief impact descriptions per rule
- ðŸ”„ **CWE/OWASP taxonomy** - Add security classification tags

### P1 - Inline Suppressions
- ðŸ”„ **`// ubon-disable-next-line RULEID`** syntax support
- ðŸ”„ **Optional reason tracking** - `// ubon-disable-next-line RULEID reason`
- ðŸ”„ **JSON/SARIF output** - Surface suppressions in machine-readable formats

### P1 - Performance Optimizations
- ðŸ”„ **Local OSV cache** with TTL for vulnerability database
- ðŸ”„ **File hash memoization** for incremental scanning
- ðŸ”„ **Bounded concurrency** for external API calls

### P1 - Enhanced Security Rules
- ðŸ”„ **JWT/cookie security** - Detect tokens in JSON responses, missing cookie flags
- ðŸ”„ **Next.js App Router** - Client/server boundary leaks, CORS issues
- ðŸ”„ **SSRF detection** - `fetch(userInput)` patterns, missing AbortController

## ðŸ“‹ Priority 2 - Automation & CI

### P2 - Expanded Auto-fixes
- ðŸ”„ **A11Y improvements** - Add alt attributes, ARIA labels automatically
- ðŸ”„ **Cookie security** - Add `HttpOnly; Secure; SameSite=Lax` flags
- ðŸ”„ **Secret removal** - Remove hardcoded credentials, logging statements
- ðŸ”„ **Network timeouts** - Wrap fetch with AbortController

### P2 - PR Workflow Integration  
- ðŸ”„ **`--apply-fixes --create-pr`** - Automated fix PRs with descriptions
- ðŸ”„ **Per-rule codemods** - Granular autofix control
- ðŸ”„ **Fix impact summaries** - Clear PR descriptions of changes made

### P2 - CI/CD Enhancements
- ðŸ”„ **"New issues only" gate** - Compare against base SHA/baseline
- ðŸ”„ **Budget mode** - Fail if exceeding error/warning thresholds
- ðŸ”„ **GitHub reviewer bot** - Inline PR comments for new findings

### P2 - Watch Mode
- ðŸ”„ **`ubon check --watch --fast`** - Incremental file change scanning
- ðŸ”„ **Hot reload integration** - Detect changes during development
- ðŸ”„ **Debounced execution** - Avoid scan spam on rapid file changes

## ðŸ”§ Priority 3 - Developer Experience

### P3 - IDE Integration
- ðŸ”„ **VS Code extension MVP** - In-editor diagnostics and quick fixes
- ðŸ”„ **Language server protocol** - Real-time feedback as you type
- ðŸ”„ **Quick fix suggestions** - Auto-fix actions directly in editor

### P3 - Enhanced Output Formats
- ðŸ”„ **Rich SARIF metadata** - `helpUri` links to rule documentation
- ðŸ”„ **Result fingerprints** - Stable IDs across reformatting
- ðŸ”„ **Schema package** - Publish `@ubon/schema` for typed consumers

### P3 - Configuration & Tuning
- ðŸ”„ **Per-rule confidence thresholds** - Fine-tune false positive rates
- ðŸ”„ **First-class ignore globs** - Exclude fixtures/mocks/stories directories
- ðŸ”„ **Guided configuration** - `ubon init --guided` interactive setup

## ðŸš€ Priority 4 - Platform Expansion

### P4 - Rails Profile Support
- ðŸ”„ **`--profile rails`** - Ruby/Rails security pattern detection
- ðŸ”„ **ActiveRecord injection** - SQL injection in Rails queries  
- ðŸ”„ **Mass assignment** - Strong parameters validation
- ðŸ”„ **ERB template security** - XSS and template injection
- ðŸ”„ **Gemfile.lock scanning** - Ruby vulnerability detection
- ðŸ”„ **Rails config security** - database.yml, secrets.yml analysis

## ðŸ“Š Success Metrics

### Performance Targets
- **Human output**: < 120ms added overhead in `--fast` mode on medium repos
- **Grouping/deduping**: Reduce visual noise by 40-60% for typical scans
- **Context snippets**: Available for 95%+ of file-based findings

### Quality Targets  
- **False positive reduction**: 30% decrease through improved context awareness
- **Autofix coverage**: 80% of A11Y001/A11Y002, cookie flags, basic secret removal
- **CI integration**: Seamless "new issues only" workflow validation

### Developer Experience
- **VS Code extension**: Sub-200ms diagnostic updates
- **JSON/SARIF**: Schema validation against sample CI runs
- **Documentation**: Complete rule coverage with remediation examples

## ðŸ”„ Migration & Compatibility

### Backward Compatibility
- All existing CLI flags and config options remain unchanged
- JSON output schema versioned (current: 1.0.0 â†’ 1.1.0)
- Baseline files from 1.0.x work with 1.1.0
- No breaking changes to programmatic API

### Upgrade Path
- `npm update ubon` - seamless upgrade for most users
- Config migration prompts for new features (suppressions, grouping)
- Optional `.ubon.config.json` enhancements (ignore globs, per-rule settings)

## ðŸ“ Documentation Updates

### User-Facing Docs
- Updated `docs/CLI.md` with new flags and examples
- Enhanced `README.md` with Rails profile information
- New `docs/SUPPRESSIONS.md` guide for inline disabling
- `docs/AUTOFIXES.md` covering safe automated repairs

### Developer Resources
- Rule documentation with CWE/OWASP mappings
- VS Code extension installation and usage guide  
- CI/CD integration examples for GitHub Actions, GitLab CI
- Schema documentation for `@ubon/schema` consumers

## ðŸŽ¯ Release Timeline

### Phase 1 (Current)
- âœ… Colorized output complete
- ðŸ”„ Result grouping and organization
- ðŸ”„ Inline suppressions

### Phase 2  
- OSV caching and performance improvements
- Enhanced security rules (JWT/cookies/SSRF)
- Basic autofixes expansion

### Phase 3
- VS Code extension MVP
- CI/CD enhancements  
- Rails profile foundation

### Phase 4
- Watch mode implementation
- Advanced autofix PRs
- Schema package publication

---

*This document will be updated as features are completed. See `CHANGELOG.md` for detailed change tracking.*
